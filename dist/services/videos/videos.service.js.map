{"version":3,"sources":["../../../src/services/videos/videos.service.ts"],"sourcesContent":["import { VideosSourceModel } from '@/models/videos/video.souce.model';\nimport { VideosModel } from '@/models/videos/videos.model';\nimport { VideosThumbnailsModel } from '@/models/videos/videos.thumnails.model';\nimport { nanoid } from 'nanoid';\nexport class VideosService {\n  public static async getVideos() {\n    return await VideosModel.findAll({\n      include: [\n        {\n          model: VideosSourceModel,\n          as: 'sources',\n        },\n        {\n          model: VideosThumbnailsModel,\n          as: 'thumbnails',\n        },\n      ],\n    });\n  }\n  //   add videos\n\n  public static async addVideos(data: any) {\n    //  check videos is already exist\n\n    try {\n      const videosExist = await VideosModel.findOne({\n        where: {\n          title: data.title,\n        },\n      });\n      if (videosExist) {\n        // create sequelize error\n\n        return 'videos already exist';\n      }\n      const videos = await VideosModel.create({\n        id: nanoid(),\n        title: data.title,\n        description: data.description,\n        tags: data.tags,\n        status: data.status ? data.status : 'active',\n        language: data.language ? data.language : 'en',\n      });\n\n      return videos;\n    } catch (err) {\n      return err;\n    }\n  }\n\n  //   add videos source\n\n  public static async addVideosSource(data: any) {\n    // check video is valid or not\n    const checkVideo = await VideosModel.findOne({\n      where: {\n        id: data.videos_id,\n      },\n    });\n    if (!checkVideo) {\n      return 'invalid video id';\n    }\n\n    // check videos source is already exist\n    const checkExist = await VideosSourceModel.findOne({\n      where: {\n        video_id: data.videos_id,\n        source: data.source,\n      },\n    });\n\n    if (checkExist) {\n      return 'videos source already exist';\n    }\n    const videosSource = await VideosSourceModel.create({\n      id: nanoid(),\n      video_id: data.videos_id,\n      source: data.source,\n      type: data.type ? data.type : 'video',\n      status: data.status ? data.status : 'active',\n      quality: data.quality ? data.quality : '720p',\n      language: data.language ? data.language : 'en',\n    });\n    return videosSource;\n  }\n\n  //   add videos thumbnails\n\n  public static async addVideosThumbnails(data: any) {\n    const videosThumbnails = await VideosThumbnailsModel.create({\n      id: nanoid(),\n      videoId: data.videoId,\n      source: data.source,\n      status: data.status ? data.status : 'active',\n      language: data.language ? data.language : 'en',\n    });\n    return videosThumbnails;\n  }\n\n  //   delete videos\n\n  public static async deleteVideos(id: string) {\n    const videos = await VideosModel.destroy({\n      where: {\n        id: id,\n      },\n    });\n    return videos;\n  }\n\n  //   delete videos source\n\n  public static async deleteVideosSource(id: string) {\n    const videosSource = await VideosSourceModel.destroy({\n      where: {\n        id: id,\n      },\n    });\n    return videosSource;\n  }\n\n  //   delete videos thumbnails\n\n  public static async deleteVideosThumbnails(id: string) {\n    const videosThumbnails = await VideosThumbnailsModel.destroy({\n      where: {\n        id: id,\n      },\n    });\n    return videosThumbnails;\n  }\n\n  //   update videos\n\n  public static async updateVideos(id: string, data: any) {\n    const videos = await VideosModel.update(\n      {\n        title: data.title,\n        description: data.description,\n        tags: data.tags,\n        status: data.status ? data.status : 'active',\n        language: data.language ? data.language : 'en',\n      },\n      {\n        where: {\n          id: id,\n        },\n      },\n    );\n    return videos;\n  }\n\n  //   update videos source\n\n  //   update videos thumbnails\n\n  public static async updateVideosThumbnails(id: string, data: any) {\n    const videosThumbnails = await VideosThumbnailsModel.update(\n      {\n        videoId: data.videoId,\n        source: data.source,\n        status: data.status ? data.status : 'active',\n        language: data.language ? data.language : 'en',\n      },\n      {\n        where: {\n          id: id,\n        },\n      },\n    );\n    return videosThumbnails;\n  }\n\n  //   change status videos\n\n  public static async changeStatusVideos(id: string, data: any) {\n    const videos = await VideosModel.update(\n      {\n        status: data.status,\n      },\n      {\n        where: {\n          id: id,\n        },\n      },\n    );\n    return videos;\n  }\n\n  //   change status videos source\n\n  //   change status videos thumbnails\n\n  public static async changeStatusVideosThumbnails(id: string, data: any) {\n    const videosThumbnails = await VideosThumbnailsModel.update(\n      {\n        status: data.status,\n      },\n      {\n        where: {\n          id: id,\n        },\n      },\n    );\n    return videosThumbnails;\n  }\n\n  //   get videos by id\n  public static async getVideosById(id: string) {\n    const videos = await VideosModel.findOne({\n      where: {\n        id: id,\n      },\n    });\n    return videos;\n  }\n\n  //   get videos source by video id\n\n  public static async getVideosSourceByVideoId(id: string) {\n    const videosSource = await VideosSourceModel.findAll({\n      where: {\n        video_id: id,\n      },\n    });\n    return videosSource;\n  }\n\n  //   get videos thumbnails by video id\n\n  public static async getVideosThumbnailsByVideoId(id: string) {\n    const videosThumbnails = await VideosThumbnailsModel.findAll({\n      where: {\n        videoId: id,\n      },\n    });\n    return videosThumbnails;\n  }\n  //   get souce by id\n\n  public static async getSourceById(id: string) {\n    const source = await VideosSourceModel.findOne({\n      where: {\n        id: id,\n      },\n    });\n    return source;\n  }\n}\n"],"names":["VideosService","getVideos","VideosModel","findAll","include","model","VideosSourceModel","as","VideosThumbnailsModel","addVideos","data","videosExist","findOne","where","title","videos","create","id","nanoid","description","tags","status","language","err","addVideosSource","checkVideo","videos_id","checkExist","video_id","source","videosSource","type","quality","addVideosThumbnails","videosThumbnails","videoId","deleteVideos","destroy","deleteVideosSource","deleteVideosThumbnails","updateVideos","update","updateVideosThumbnails","changeStatusVideos","changeStatusVideosThumbnails","getVideosById","getVideosSourceByVideoId","getVideosThumbnailsByVideoId","getSourceById"],"mappings":";;;;+BAIaA;;;eAAAA;;;iCAJqB;6BACN;sCACU;wBACf;AAChB,IAAA,AAAMA,gBAAN,MAAMA;IACX,aAAoBC,YAAY;QAC9B,OAAO,MAAMC,wBAAW,CAACC,OAAO,CAAC;YAC/BC,SAAS;gBACP;oBACEC,OAAOC,kCAAiB;oBACxBC,IAAI;gBACN;gBACA;oBACEF,OAAOG,2CAAqB;oBAC5BD,IAAI;gBACN;aACD;QACH;IACF;IAGA,aAAoBE,UAAUC,IAAS,EAAE;QAGvC,IAAI;YACF,MAAMC,cAAc,MAAMT,wBAAW,CAACU,OAAO,CAAC;gBAC5CC,OAAO;oBACLC,OAAOJ,KAAKI,KAAK;gBACnB;YACF;YACA,IAAIH,aAAa;gBAGf,OAAO;YACT,CAAC;YACD,MAAMI,SAAS,MAAMb,wBAAW,CAACc,MAAM,CAAC;gBACtCC,IAAIC,IAAAA,cAAM;gBACVJ,OAAOJ,KAAKI,KAAK;gBACjBK,aAAaT,KAAKS,WAAW;gBAC7BC,MAAMV,KAAKU,IAAI;gBACfC,QAAQX,KAAKW,MAAM,GAAGX,KAAKW,MAAM,GAAG,QAAQ;gBAC5CC,UAAUZ,KAAKY,QAAQ,GAAGZ,KAAKY,QAAQ,GAAG,IAAI;YAChD;YAEA,OAAOP;QACT,EAAE,OAAOQ,KAAK;YACZ,OAAOA;QACT;IACF;IAIA,aAAoBC,gBAAgBd,IAAS,EAAE;QAE7C,MAAMe,aAAa,MAAMvB,wBAAW,CAACU,OAAO,CAAC;YAC3CC,OAAO;gBACLI,IAAIP,KAAKgB,SAAS;YACpB;QACF;QACA,IAAI,CAACD,YAAY;YACf,OAAO;QACT,CAAC;QAGD,MAAME,aAAa,MAAMrB,kCAAiB,CAACM,OAAO,CAAC;YACjDC,OAAO;gBACLe,UAAUlB,KAAKgB,SAAS;gBACxBG,QAAQnB,KAAKmB,MAAM;YACrB;QACF;QAEA,IAAIF,YAAY;YACd,OAAO;QACT,CAAC;QACD,MAAMG,eAAe,MAAMxB,kCAAiB,CAACU,MAAM,CAAC;YAClDC,IAAIC,IAAAA,cAAM;YACVU,UAAUlB,KAAKgB,SAAS;YACxBG,QAAQnB,KAAKmB,MAAM;YACnBE,MAAMrB,KAAKqB,IAAI,GAAGrB,KAAKqB,IAAI,GAAG,OAAO;YACrCV,QAAQX,KAAKW,MAAM,GAAGX,KAAKW,MAAM,GAAG,QAAQ;YAC5CW,SAAStB,KAAKsB,OAAO,GAAGtB,KAAKsB,OAAO,GAAG,MAAM;YAC7CV,UAAUZ,KAAKY,QAAQ,GAAGZ,KAAKY,QAAQ,GAAG,IAAI;QAChD;QACA,OAAOQ;IACT;IAIA,aAAoBG,oBAAoBvB,IAAS,EAAE;QACjD,MAAMwB,mBAAmB,MAAM1B,2CAAqB,CAACQ,MAAM,CAAC;YAC1DC,IAAIC,IAAAA,cAAM;YACViB,SAASzB,KAAKyB,OAAO;YACrBN,QAAQnB,KAAKmB,MAAM;YACnBR,QAAQX,KAAKW,MAAM,GAAGX,KAAKW,MAAM,GAAG,QAAQ;YAC5CC,UAAUZ,KAAKY,QAAQ,GAAGZ,KAAKY,QAAQ,GAAG,IAAI;QAChD;QACA,OAAOY;IACT;IAIA,aAAoBE,aAAanB,EAAU,EAAE;QAC3C,MAAMF,SAAS,MAAMb,wBAAW,CAACmC,OAAO,CAAC;YACvCxB,OAAO;gBACLI,IAAIA;YACN;QACF;QACA,OAAOF;IACT;IAIA,aAAoBuB,mBAAmBrB,EAAU,EAAE;QACjD,MAAMa,eAAe,MAAMxB,kCAAiB,CAAC+B,OAAO,CAAC;YACnDxB,OAAO;gBACLI,IAAIA;YACN;QACF;QACA,OAAOa;IACT;IAIA,aAAoBS,uBAAuBtB,EAAU,EAAE;QACrD,MAAMiB,mBAAmB,MAAM1B,2CAAqB,CAAC6B,OAAO,CAAC;YAC3DxB,OAAO;gBACLI,IAAIA;YACN;QACF;QACA,OAAOiB;IACT;IAIA,aAAoBM,aAAavB,EAAU,EAAEP,IAAS,EAAE;QACtD,MAAMK,SAAS,MAAMb,wBAAW,CAACuC,MAAM,CACrC;YACE3B,OAAOJ,KAAKI,KAAK;YACjBK,aAAaT,KAAKS,WAAW;YAC7BC,MAAMV,KAAKU,IAAI;YACfC,QAAQX,KAAKW,MAAM,GAAGX,KAAKW,MAAM,GAAG,QAAQ;YAC5CC,UAAUZ,KAAKY,QAAQ,GAAGZ,KAAKY,QAAQ,GAAG,IAAI;QAChD,GACA;YACET,OAAO;gBACLI,IAAIA;YACN;QACF;QAEF,OAAOF;IACT;IAMA,aAAoB2B,uBAAuBzB,EAAU,EAAEP,IAAS,EAAE;QAChE,MAAMwB,mBAAmB,MAAM1B,2CAAqB,CAACiC,MAAM,CACzD;YACEN,SAASzB,KAAKyB,OAAO;YACrBN,QAAQnB,KAAKmB,MAAM;YACnBR,QAAQX,KAAKW,MAAM,GAAGX,KAAKW,MAAM,GAAG,QAAQ;YAC5CC,UAAUZ,KAAKY,QAAQ,GAAGZ,KAAKY,QAAQ,GAAG,IAAI;QAChD,GACA;YACET,OAAO;gBACLI,IAAIA;YACN;QACF;QAEF,OAAOiB;IACT;IAIA,aAAoBS,mBAAmB1B,EAAU,EAAEP,IAAS,EAAE;QAC5D,MAAMK,SAAS,MAAMb,wBAAW,CAACuC,MAAM,CACrC;YACEpB,QAAQX,KAAKW,MAAM;QACrB,GACA;YACER,OAAO;gBACLI,IAAIA;YACN;QACF;QAEF,OAAOF;IACT;IAMA,aAAoB6B,6BAA6B3B,EAAU,EAAEP,IAAS,EAAE;QACtE,MAAMwB,mBAAmB,MAAM1B,2CAAqB,CAACiC,MAAM,CACzD;YACEpB,QAAQX,KAAKW,MAAM;QACrB,GACA;YACER,OAAO;gBACLI,IAAIA;YACN;QACF;QAEF,OAAOiB;IACT;IAGA,aAAoBW,cAAc5B,EAAU,EAAE;QAC5C,MAAMF,SAAS,MAAMb,wBAAW,CAACU,OAAO,CAAC;YACvCC,OAAO;gBACLI,IAAIA;YACN;QACF;QACA,OAAOF;IACT;IAIA,aAAoB+B,yBAAyB7B,EAAU,EAAE;QACvD,MAAMa,eAAe,MAAMxB,kCAAiB,CAACH,OAAO,CAAC;YACnDU,OAAO;gBACLe,UAAUX;YACZ;QACF;QACA,OAAOa;IACT;IAIA,aAAoBiB,6BAA6B9B,EAAU,EAAE;QAC3D,MAAMiB,mBAAmB,MAAM1B,2CAAqB,CAACL,OAAO,CAAC;YAC3DU,OAAO;gBACLsB,SAASlB;YACX;QACF;QACA,OAAOiB;IACT;IAGA,aAAoBc,cAAc/B,EAAU,EAAE;QAC5C,MAAMY,SAAS,MAAMvB,kCAAiB,CAACM,OAAO,CAAC;YAC7CC,OAAO;gBACLI,IAAIA;YACN;QACF;QACA,OAAOY;IACT;AACF"}